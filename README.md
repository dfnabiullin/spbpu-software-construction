
# Виктор-Бот

Телеграм-бот для создания, редактирования и прохождения викторин.

## Команды
- `/help` - получить справку о доступных командах
- `/create` - создать новую викторину
    - `/cancelCreate` - отменить создание
- `/attempt` - принять участие в викторине
    - `/cancelAttempt` - выйти из викторины
- `/rename` - переименовать викторину
- `/remove` - удалить викторину
    - `/cancelEdit` - отменить изменения

## Виды вопросов

### Выбор нескольких вариантов

Виктор-Бот - это ..?

1. Телеграм-бот
2. Питоновское приложение
3. Город

Ответ: Телеграм-бот, Питоновское приложение

### Выбор одного варианта

Виктор-Бот - это ..?

1. Телеграм-бот
2. Тыр пыр
3. Восемь дыр

Ответ: Телеграм-бот

### Да/нет

Дорога с твердым покрытием по отношению к грунтовой - главная?

- Да
- Нет

Ответ: Да

### Ответ - число

Сколько букв в аббревиатуре ИКНК?

Ответ: 4

### Ответ - строка

Какая фамилия у Тимура?

Ответ: Карама

## Стек технологий

Бот написан на языке Python при помощи библиотеки `python-telegram-bot` и сопровождён тестами, использующими библиотеку `pytest`.

Хранение и изменение информации о существующих викторинах осуществляется в No-SQL-базе данных MongoDB. Взаимодействие кода с базой обеспечено библиотекой `pymongo`.

При помощи интерфейса `mongo-express` состояние базы можно проверить в браузере.

## Развёртывание

Чтобы развернуть бота локально, необходимо:
- Установить Docker
- В файле `docker-compose.yml` указать токен телеграм-бота, предварительно созданного в самом Телеграме при помощи Bot Father (ниже - `<токен>`), а также имя и пароль пользователя, которому предоставлены права на базу MongoDB (ниже - `<имя>` и `<пароль>`):

```yml
services:
  bot:
    build: .
    environment:
      MONGODB: mongodb://<имя>:<пароль>@mongo:27017/
      TELEGRAM_TOKEN: <токен>
  mongo:
    image: mongo:4.4.29
    restart: always
    environment:
      MONGO_INITDB_ROOT_USERNAME: <имя>
      MONGO_INITDB_ROOT_PASSWORD: <пароль>

  mongo-express:
    image: mongo-express
    restart: always
    ports:
      - 8081:8081
    environment:
      ME_CONFIG_MONGODB_ADMINUSERNAME: <имя>
      ME_CONFIG_MONGODB_ADMINPASSWORD: <пароль>
      ME_CONFIG_MONGODB_URL: mongodb://<имя>:<пароль>@mongo:27017/
```
- В директории проекта вызвать команду:
```sh
$ docker-compose up
```
После этого загрузятся необходимые образы, запустятся контейнеры, и с ботом можно будет непосредственно взаимодействовать в Телеграме. Также можно будет посмотреть состояние базы данных по адресу http://localhost:8081.